{% extends 'main.html' %}
{% block content %}
{% include 'navbar.html' %}

<div class="flex-1 ml-64 p-8" id="main-content">
    <!-- Cartões de Estatísticas -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8" id="stats-cards">
        <!-- Seus cards existentes aqui (mantenha como estão) -->
        <!-- Vendas do Dia -->
        <div class="bg-white rounded-xl shadow-sm p-6 border border-pharmacy-gray">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Vendas do Dia</p>
                    <p class="text-2xl font-bold text-gray-900">{{ total_vendas_hoje|floatformat:2 }} MT</p>
                    <p class="text-sm text-pharmacy-green">
                        {% if total_vendas_hoje > 0 %}+{% else %}—{% endif %}
                    </p>
                </div>
                <div class="bg-pharmacy-green-light/10 p-3 rounded-lg">
                    <i class="text-pharmacy-green-dark text-xl">
                        <svg aria-hidden="true" class="svg-inline--fa fa-chart-line" data-icon="chart-line"
                             data-prefix="fas" focusable="false" role="img" viewBox="0 0 512 512"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M64 64c0-17.7-14.3-32-32-32S0 46.3 0 64V400c0 44.2 35.8 80 80 80H480c17.7 0 32-14.3 32-32s-14.3-32-32-32H80c-8.8 0-16-7.2-16-16V64zm406.6 86.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L320 210.7l-57.4-57.4c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L240 221.3l57.4 57.4c12.5 12.5 32.8 12.5 45.3 0l128-128z"
                                  fill="currentColor"></path>
                        </svg>
                    </i>
                </div>
            </div>
        </div>

        <!-- Estoque Baixo -->
        <div class="bg-white rounded-xl shadow-sm p-6 border border-pharmacy-gray">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Estoque Baixo</p>
                    <p class="text-2xl font-bold text-orange-600">{{ estoque_baixo }}</p>
                    <p class="text-sm text-orange-500">produtos</p>
                </div>
                <div class="bg-orange-50 p-3 rounded-lg">
                    <i class="text-orange-600 text-xl">
                        <svg aria-hidden="true" class="svg-inline--fa fa-boxes-stacked" data-icon="boxes-stacked"
                             data-prefix="fas" focusable="false" role="img" viewBox="0 0 576 512"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M248 0H208c-26.5 0-48 21.5-48 48V160c0 35.3 28.7 64 64 64H352c35.3 0 64-28.7 64-64V48c0-26.5-21.5-48-48-48H328V80c0 8.8-7.2 16-16 16H264c-8.8 0-16-7.2-16-16V0zM64 256c-35.3 0-64 28.7-64 64V448c0 35.3 28.7 64 64 64H224c35.3 0 64-28.7 64-64V320c0-35.3-28.7-64-64-64H184v80c0 8.8-7.2 16-16 16H120c-8.8 0-16-7.2-16-16V256H64zM352 512H512c35.3 0 64-28.7 64-64V320c0-35.3-28.7-64-64-64H472v80c0 8.8-7.2 16-16 16H408c-8.8 0-16-7.2-16-16V256H352c-15 0-28.8 5.1-39.7 13.8c4.9 10.4 7.7 22 7.7 34.2V464c0 12.2-2.8 23.8-7.7 34.2C323.2 506.9 337 512 352 512z"
                                  fill="currentColor"></path>
                        </svg>
                    </i>
                </div>
            </div>
        </div>

        <!-- Validade Próxima -->
        <div class="bg-white rounded-xl shadow-sm p-6 border border-pharmacy-gray">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Validade Próxima</p>
                    <p class="text-2xl font-bold text-red-600">{{ validade_proxima }}</p>
                    <p class="text-sm text-red-500">produtos</p>
                </div>
                <div class="bg-red-50 p-3 rounded-lg">
                    <i class="text-red-600 text-xl">
                        <svg aria-hidden="true" class="svg-inline--fa fa-calendar-xmark" data-icon="calendar-xmark"
                             data-prefix="fas" focusable="false" role="img" viewBox="0 0 512 512"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M160 0c17.7 0 32 14.3 32 32V64H320V32c0-17.7 14.3-32 32-32s32 14.3 32 32V64h48c26.5 0 48 21.5 48 48v48H32V112c0-26.5 21.5-48 48-48h48V32c0-17.7 14.3-32 32-32zM32 192H480V464c0 26.5-21.5 48-48 48H80c-26.5 0-48-21.5-48-48V192zM337 305c9.4-9.4 9.4-24.6 0-33.9s-24.6-9.4-33.9 0l-47 47-47-47c-9.4-9.4-24.6-9.4-33.9 0s-9.4 24.6 0 33.9l47 47-47 47c-9.4 9.4-9.4 24.6 0 33.9s24.6 9.4 33.9 0l47-47 47 47c9.4 9.4 24.6 9.4 33.9 0s9.4-24.6 0-33.9l-47-47 47-47z"
                                  fill="currentColor"></path>
                        </svg>
                    </i>
                </div>
            </div>
        </div>

        <!-- Receita dos Últimos 30 Dias -->
        <div class="bg-white rounded-xl shadow-sm p-6 border border-pharmacy-gray">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Receita Últimos 30 Dias</p>
                    <p class="text-2xl font-bold text-gray-900">{{ receita_ultimos_30_dias|floatformat:2 }} MT</p>
                    <p class="text-sm text-pharmacy-green"></p>
                </div>
                <div class="bg-blue-50 p-3 rounded-lg">
                    <i class="text-blue-600 text-xl">
                        <svg aria-hidden="true" class="svg-inline--fa fa-coins" data-icon="coins"
                             data-prefix="fas" focusable="false" role="img" viewBox="0 0 512 512"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M512 80c0 18-14.3 34.6-38.4 48c-29.1 16.1-72.5 27.5-122.3 30.9c-3.7-1.8-7.4-3.5-11.3-5C300.6 137.4 248.2 128 192 128c-8.3 0-16.4 .2-24.5 .6l-1.1-.6C142.3 114.6 128 98 128 80c0-44.2 86-80 192-80S512 35.8 512 80zM160.7 161.1c10.2-.7 20.7-1.1 31.3-1.1c62.2 0 117.4 12.3 152.5 31.4C369.3 204.9 384 221.7 384 240c0 4-.7 7.9-2.1 11.7c-4.6 13.2-17 25.3-35 35.5c0 0 0 0 0 0c-.1 .1-.3 .1-.4 .2l0 0 0 0c-.3 .2-.6 .3-.9 .5c-35 19.4-90.8 32-153.6 32c-59.6 0-112.9-11.3-148.2-29.1c-1.9-.9-3.7-1.9-5.5-2.9C14.3 274.6 0 258 0 240c0-34.8 53.4-64.5 128-75.4c10.5-1.5 21.4-2.7 32.7-3.5zM416 240c0-21.9-10.6-39.9-24.1-53.4c28.3-4.4 54.2-11.4 76.2-20.5c16.3-6.8 31.5-15.2 43.9-25.5V176c0 19.3-16.5 37.1-43.8 50.9c-14.6 7.4-32.4 13.7-52.4 18.5c.1-1.8 .2-3.5 .2-5.3zm-32 96c0 18-14.3 34.6-38.4 48c-1.8 1-3.6 1.9-5.5 2.9C304.9 404.7 251.6 416 192 416c-62.8 0-118.6-12.6-153.6-32C14.3 370.6 0 354 0 336V300.6c12.5 10.3 27.6 18.7 43.9 25.5C83.4 342.6 135.8 352 192 352s108.6-9.4 148.1-25.9c7.8-3.2 15.3-6.9 22.4-10.9c6.1-3.4 11.8-7.2 17.2-11.2c1.5-1.1 2.9-2.3 4.3-3.4V304 5.7V336zm32 0V304 278.1c19-4.2 36.5-9.5 52.1-16c16.3-6.8 31.5-15.2 43.9-25.5V272c0 10.5-5 21-14.9 30.9c-16.3 16.3-45 29.7-81.3 38.4c.1-1.7 .2-3.5 .2-5.3zM192 448c56.2 0 108.6-9.4 148.1-25.9c16.3-6.8 31.5-15.2 43.9-25.5V432c0 44.2-86 80-192 80S0 476.2 0 432V396.6c12.5 10.3 27.6 18.7 43.9 25.5C83.4 438.6 135.8 448 192 448z"
                                  fill="currentColor"></path>
                        </svg>
                    </i>
                </div>
            </div>
        </div>
    </div>
    <!-- Gráficos -->
        <div class="grid grid-cols-2 lg:grid-cols-2 gap-8" id="charts-section">
        <!-- Gráfico de Pizza - Produtos Mais Vendidos -->
        <div class="bg-white rounded-xl shadow-sm border border-pharmacy-gray p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-gray-900">
                    <i class="mr-2 text-pharmacy-green-dark">
                        <svg aria-hidden="true" class="svg-inline--fa fa-chart-pie" data-icon="chart-pie"
                             data-prefix="fas" focusable="false" role="img" viewBox="0 0 576 512"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M304 240V16.6c0-9 7-16.6 16-16.6C443.7 0 544 100.3 544 224c0 9-7.6 16-16.6 16H304zM32 272C32 150.7 122.1 50.3 239 34.3c9.2-1.3 17 6.1 17 15.4V288L412.5 444.5c6.7 6.7 6.2 17.7-1.5 23.1C371.8 495.6 323.8 512 272 512C139.5 512 32 404.6 32 272zm526.4 16c9.3 0 16.6 7.8 15.4 17c-7.7 55.9-34.6 105.6-73.9 142.3c-6 5.6-15.4 5.2-21.2-.7L320 288H558.4z"
                                  fill="currentColor"></path>
                        </svg>
                    </i>
                    Produtos Mais Vendidos
                </h3>
            </div>
            <div class="h-80" id="pie-chart"></div>
        </div>

        <!-- Gráfico de Barras - Vendas por Semana -->
        <div class="bg-white rounded-xl shadow-sm border border-pharmacy-gray p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-lg font-semibold text-gray-900">
                    <i class="mr-2 text-pharmacy-green-dark">
                        <svg aria-hidden="true" class="svg-inline--fa fa-chart-bar" data-icon="chart-bar"
                             data-prefix="fas" focusable="false" role="img" viewBox="0 0 512 512"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M32 32c17.7 0 32 14.3 32 32V400c0 8.8 7.2 16 16 16H480c17.7 0 32 14.3 32 32s-14.3 32-32 32H80c-44.2 0-80-35.8-80-80V64C0 46.3 14.3 32 32 32zm96 96c0-17.7 14.3-32 32-32l192 0c17.7 0 32 14.3 32 32s-14.3 32-32 32l-192 0c-17.7 0-32-14.3-32-32zm32 64H288c17.7 0 32 14.3 32 32s-14.3 32-32 32H160c-17.7 0-32-14.3-32-32s14.3-32 32-32zm0 96H416c17.7 0 32 14.3 32 32s-14.3 32-32 32H160c-17.7 0-32-14.3-32-32s14.3-32 32-32z"
                                  fill="currentColor"></path>
                        </svg>
                    </i>
                    Vendas dos Últimos 30 Dias
                </h3>
            </div>
            <div class="h-80" id="bar-chart"></div>
        </div>

    </div>


    <!-- Tabela de Produtos com Validade Próxima -->
<div class="bg-white rounded-xl shadow-sm border border-pharmacy-gray p-6 mb-8">
    <div class="flex items-center justify-between mb-6">

        <div>
            <h3 class="text-lg font-semibold text-gray-900">
                <i class="mr-2 text-red-600">
                    <svg aria-hidden="true" class="svg-inline--fa fa-clock" data-icon="clock" data-prefix="fas"
                         focusable="false" role="img" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg">
                        <path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM184 232V328c0 13.3 10.7 24 24 24s24-10.7 24-24V232c0-13.3-10.7-24-24-24s-24 10.7-24 24zM328 232V328c0 13.3 10.7 24 24 24s24-10.7 24-24V232c0-13.3-10.7-24-24-24s-24 10.7-24 24z" fill="currentColor"/>
                    </svg>
                </i>
                Produtos com Validade Próxima
            </h3>
            <p class="text-sm text-gray-500 mt-1">
                Mostrando {{ produtos_validade_proxima.start_index }} - {{ produtos_validade_proxima.end_index }} de {{ validade_proxima }} produtos
            </p>
        </div>

        <!-- Botão de Exportar para Excel -->
            <a href="{% url 'exportar_validade_excel' %}"
               class="inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white text-sm font-medium rounded-lg transition-colors duration-200 shadow-sm">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                          d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                </svg>
                Exportar Excel
            </a>
    </div>

    {% if produtos_validade_proxima %}
    <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200">
            <thead class="bg-gray-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Produto
                    </th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Lote
                    </th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Quantidade
                    </th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Data de Validade
                    </th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Dias Restantes
                    </th>
                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                        Status
                    </th>
                </tr>
            </thead>
            <tbody class="bg-white divide-y divide-gray-200">
                {% for lote in produtos_validade_proxima %}
                <tr class="hover:bg-gray-50 transition-colors duration-150">
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="ml-4">
                                <div class="text-sm font-medium text-gray-900">{{ lote.produto.nome }}</div>
                                {% if lote.produto.codigo %}
                                <div class="text-sm text-gray-500">Código: {{ lote.produto.codigo }}</div>
                                {% endif %}
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">{{ lote.numero_lote|default:"-" }}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">{{ lote.quantidade_disponivel }}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm text-gray-900">{{ lote.data_validade|date:"d/m/Y" }}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                            {% if lote.dias_para_vencer <= 0 %}bg-red-100 text-red-800
                            {% elif lote.dias_para_vencer <= 7 %}bg-red-100 text-red-800
                            {% elif lote.dias_para_vencer <= 30 %}bg-orange-100 text-orange-800
                            {% else %}bg-yellow-100 text-yellow-800{% endif %}">
                            {% if lote.dias_para_vencer <= 0 %}
                            Vencido há {{ lote.dias_absolutos }} dias
                            {% else %}
                            {{ lote.dias_para_vencer }} dias
                            {% endif %}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        {% if lote.dias_para_vencer <= 0 %}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                            <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-red-400" fill="currentColor" viewBox="0 0 8 8">
                                <circle cx="4" cy="4" r="3" />
                            </svg>
                            Vencido
                        </span>
                        {% elif lote.dias_para_vencer <= 7 %}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                            <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-red-400" fill="currentColor" viewBox="0 0 8 8">
                                <circle cx="4" cy="4" r="3" />
                            </svg>
                            Crítico
                        </span>
                        {% elif lote.dias_para_vencer <= 30 %}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800">
                            <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-orange-400" fill="currentColor" viewBox="0 0 8 8">
                                <circle cx="4" cy="4" r="3" />
                            </svg>
                            Alerta
                        </span>
                        {% else %}
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                            <svg class="-ml-0.5 mr-1.5 h-2 w-2 text-yellow-400" fill="currentColor" viewBox="0 0 8 8">
                                <circle cx="4" cy="4" r="3" />
                            </svg>
                            Atenção
                        </span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <!-- Paginação -->
    {% if produtos_validade_proxima.paginator.num_pages > 1 %}
    <div class="flex items-center justify-between mt-6 px-4 py-3 bg-gray-50 border-t border-gray-200 sm:px-6 rounded-b-lg">
        <div class="flex justify-between flex-1 sm:hidden">
            {% if produtos_validade_proxima.has_previous %}
            <a href="?page_validade={{ produtos_validade_proxima.previous_page_number }}{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
               class="relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
                Anterior
            </a>
            {% endif %}
            {% if produtos_validade_proxima.has_next %}
            <a href="?page_validade={{ produtos_validade_proxima.next_page_number }}{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
               class="relative inline-flex items-center px-4 py-2 ml-3 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50">
                Próxima
            </a>
            {% endif %}
        </div>
        <div class="hidden sm:flex sm:flex-1 sm:items-center sm:justify-between">
            <div>
                <p class="text-sm text-gray-700">
                    Mostrando
                    <span class="font-medium">{{ produtos_validade_proxima.start_index }}</span>
                    a
                    <span class="font-medium">{{ produtos_validade_proxima.end_index }}</span>
                    de
                    <span class="font-medium">{{ produtos_validade_proxima.paginator.count }}</span>
                    resultados
                </p>
            </div>
            <div>
                <nav class="inline-flex -space-x-px rounded-md shadow-sm" aria-label="Pagination">
                    {% if produtos_validade_proxima.has_previous %}
                    <a href="?page_validade={{ produtos_validade_proxima.previous_page_number }}{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
                       class="relative inline-flex items-center px-2 py-2 text-gray-400 rounded-l-md border border-gray-300 bg-white hover:bg-gray-50">
                        <span class="sr-only">Anterior</span>
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                    </a>
                    {% endif %}

                    {% for num in produtos_validade_proxima.paginator.page_range %}
                        {% if produtos_validade_proxima.number == num %}
                        <span class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-pharmacy-green text-white font-medium">
                            {{ num }}
                        </span>
                        {% elif num > produtos_validade_proxima.number|add:'-3' and num < produtos_validade_proxima.number|add:'3' %}
                        <a href="?page_validade={{ num }}{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
                           class="relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-gray-700 hover:bg-gray-50">
                            {{ num }}
                        </a>
                        {% endif %}
                    {% endfor %}

                    {% if produtos_validade_proxima.has_next %}
                    <a href="?page_validade={{ produtos_validade_proxima.next_page_number }}{% if request.GET.page %}&page={{ request.GET.page }}{% endif %}"
                       class="relative inline-flex items-center px-2 py-2 text-gray-400 rounded-r-md border border-gray-300 bg-white hover:bg-gray-50">
                        <span class="sr-only">Próxima</span>
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                        </svg>
                    </a>
                    {% endif %}
                </nav>
            </div>
        </div>
    </div>
    {% endif %}

    {% else %}
    <div class="text-center py-8">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <h3 class="mt-2 text-sm font-medium text-gray-900">Nenhum produto com validade próxima</h3>
        <p class="mt-1 text-sm text-gray-500">Todos os produtos estão com validade em dia.</p>
    </div>
    {% endif %}
</div>


</div>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // Gráfico de Pizza - Produtos Mais Vendidos
        Highcharts.chart('pie-chart', {
            chart: {
                type: 'pie',
                backgroundColor: 'transparent',
                height: 320
            },
            title: {
                text: null
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.y:.0f} unidades</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: true,
                        format: '<b>{point.name}</b>: {point.y:.0f}'
                    },
                    colors: ['#22c55e', '#4ade80', '#86efac', '#bbf7d0', '#dcfce7']
                }
            },
            series: [{
                name: 'Unidades Vendidas',
                colorByPoint: true,
                data: {{ produtos_pizza|safe }}
            }]
        });

        // Gráfico de Barras - Vendas dos Últimos 30 Dias
        Highcharts.chart('bar-chart', {
            chart: {
                type: 'column',
                backgroundColor: 'transparent',
                height: 320
            },
            title: {
                text: null
            },
            xAxis: {
                categories: {{ categorias_30_dias|safe }},
                crosshair: true
            },
            yAxis: {
                min: 0,
                title: {
                    text: 'Vendas (MT)'
                }
            },
            tooltip: {
                headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.2f} MT</b></td></tr>',
                footerFormat: '</table>',
                shared: true,
                useHTML: true
            },
            plotOptions: {
                column: {
                    pointPadding: 0.2,
                    borderWidth: 0,
                    color: '#22c55e'
                }
            },
            series: [{
                name: 'Vendas',
                data: {{ vendas_ultimos_30_dias|safe }}
            }]
        });
    });
</script>
{% endblock %}
